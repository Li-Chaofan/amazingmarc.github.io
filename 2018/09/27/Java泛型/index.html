<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.lug.ustc.edu.cn/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Java, Meituan" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="概述在java代码开发中，泛型的使用是非常普遍的，特别是在集合中。那么，其实java中的泛型并不是真正意义上的新的类型，只是java语法中的语法糖已。便于java编译器在编译源代码的时候进行类型校验，及早发现程序错误而已，今天我们详细分析一下泛型的知识。">
<meta property="og:type" content="article">
<meta property="og:title" content="JAVA泛型">
<meta property="og:url" content="http://yoursite.com/2018/09/27/Java泛型/index.html">
<meta property="og:site_name" content="李超凡的读书笔记">
<meta property="og:description" content="概述在java代码开发中，泛型的使用是非常普遍的，特别是在集合中。那么，其实java中的泛型并不是真正意义上的新的类型，只是java语法中的语法糖已。便于java编译器在编译源代码的时候进行类型校验，及早发现程序错误而已，今天我们详细分析一下泛型的知识。">
<meta property="og:image" content="http://yoursite.com/upload/generic_type_herit.png">
<meta property="og:updated_time" content="2018-09-28T01:29:58.528Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JAVA泛型">
<meta name="twitter:description" content="概述在java代码开发中，泛型的使用是非常普遍的，特别是在集合中。那么，其实java中的泛型并不是真正意义上的新的类型，只是java语法中的语法糖已。便于java编译器在编译源代码的时候进行类型校验，及早发现程序错误而已，今天我们详细分析一下泛型的知识。">
<meta name="twitter:image" content="http://yoursite.com/upload/generic_type_herit.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/09/27/Java泛型/"/>





  <title> JAVA泛型 | 李超凡的读书笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">李超凡的读书笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/27/Java泛型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="marc">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/lufei.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李超凡的读书笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                JAVA泛型
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-27T09:26:00+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>在java代码开发中，泛型的使用是非常普遍的，特别是在集合中。那么，其实java中的泛型并不是真正意义上的新的类型，只是java语法中的语法糖已。便于java编译器在编译源代码的时候进行类型校验，及早发现程序错误而已，今天我们详细分析一下泛型的知识。</p>
<a id="more"></a>
<h1 id="泛型Type与Class"><a href="#泛型Type与Class" class="headerlink" title="泛型Type与Class"></a>泛型Type与Class</h1><p>下面可以来讨论看看泛型-Type接口-Class类型之间的关系？</p>
<ol>
<li><p>泛型出现之前的类型<br>在JDK1.5之前，没有引入泛型类型的概念的时候，只有所谓的原始类型(相对于泛型参数化的List<string>来说，List就是原始类型)，所有的原始类型都是通过字节码文件类Class类进行抽象。java.lang.Class类的一个具体对象就代表一个指定的原始类型。(eg: String原始类型抽象类即为:String.class….)</string></p>
</li>
<li><p>泛型出现后的类型<br>泛型&lt;&gt;类型出现之后，就扩充了数据类型。即在原始类型的基础上，添加泛型的特性，就能代表或者说表达更多的数据类型。从只有原始类型扩充了参数化类型(ParameterizedType)，类型变量类型(TypeVariable)，泛型限定的参数化类型（含通配符+通配符限定表达式。即 ? extends , super等），泛型数组类型(GenericArrayType)。</p>
</li>
<li><p>与泛型有关的类型不能和原始类型统一到Class的原因(泛型类型与对应的原始类型对应相同的Class)<br>上面这个原因要说的意思是：泛型类型所代表的Class对象与对应的原始类型对应的Class是同一个对象，例如：List<string>,List<integer>..等等与原始类型List，所代表的Class类都是java.util.List。因为会有”类型擦除”原因</integer></string></p>
<ul>
<li><p>产生泛型擦除的原因<br>本来新产生的类型+原始类型都应该统一成各自的字节码文件Class类型对象，但是由于泛型不是最初的Java的基础部分，如果真的要加入的真正的泛型，会涉及到JVM指令集的修改，这样代价就太大了。多说一句：在java中的泛型并不是代表着真正的新的类型，只是一个语法糖，便于类型检查和编译器优化的手段而已。</p>
</li>
<li><p>Java中如何引入泛型<br>为了使用泛型的优势而又不真正引入泛型，java采用“泛型擦除”的机制来引入泛型这个语法糖。所以Java中的泛型仅仅是给编译器javac使用的，用来确保数据的安全性和免去强制类型转换的麻烦。结果就是，一旦含有泛型声明和定义使用的代码地方，经过编译完成之后，所有和泛型有关的类型就会被全部擦除，也就是被清理掉。(List<string> list = new ArrayLIst<string>() 会编译成  List list = new ArrayList( ))。</string></string></p>
</li>
</ul>
</li>
<li><p>Class不能表达与泛型有关的类型<br>由于编译器的”擦除”机制，就造成了与泛型有关的如参数化类型，类型变量类型，泛型限定的参数化类型，数组类型，都会被全部打回原形，在字节码文件中中全部都是泛型擦除后的原始类型，并不存在和自身类型一致的字节码文件。所以，和泛型相关的新扩充进行的类型不能被统一到Class类中，即List<string>并不能用类似List<string>.class这个Class类文件来表示类型。</string></string></p>
</li>
<li><p>与泛型有关的类型在java中的表示<br>为了通过反射操作这些类型来迎合实际的开发需要，Java就新增加了ParameterizedType，GenericArrayType,TypeVariable,WildcardType这几种类型来代表不能被归一到Class类中的类型，但是又是和原始类型不同且齐名同等级的类型。</p>
</li>
<li><p>Type接口的引入：统一与泛型有关的类型和原始类型Class</p>
<ul>
<li>引入Type的原因<br>为了程序的扩展性，最终引入了Type接口作为Class,ParameterizedType，GenericArrayType,TypeVariable,WildcardType这几种类型的公共父接口。这样实现了Type接口类型参数，并可以接收以上五种子类的实参或者返回值类型就是Type型的参数。</li>
<li>Type接口中没有方法的原因<br>从上面看到，Type接口出现仅仅起到了通过多态来达到程序类型扩展性提高的作用，并没有其他的作用。所有，没有必要提供任何方法。</li>
</ul>
</li>
</ol>
<h1 id="Type详解"><a href="#Type详解" class="headerlink" title="Type详解"></a>Type详解</h1><p>Tyep接口包含如下子类（子接口）<br><img src="/upload/generic_type_herit.png" alt="avatar"></p>
<p>下面分别总结每种类型的含义和使用场景。</p>
<h2 id="参数化类型ParameterizedType"><a href="#参数化类型ParameterizedType" class="headerlink" title="参数化类型ParameterizedType"></a>参数化类型ParameterizedType</h2><p>在Java中，参数化类型使用java.lang.reflect.ParameterizedType表示，接口定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ParameterizedType</span> <span class="keyword">extends</span> <span class="title">Type</span> </span>&#123;</div><div class="line">    <span class="comment">/**</div><div class="line">    * 获取泛型类型的参数化类型</div><div class="line">    * 比如Map&lt;String,String&gt; 那么返回值中Type数组就为 [String,String]</div><div class="line">    */</span></div><div class="line">    Type[] getActualTypeArguments();</div><div class="line"></div><div class="line">    <span class="comment">/**</div><div class="line">     * 返回原始类型</div><div class="line">     * 比如Map&lt;String,String&gt; 那么返回值为Map</div><div class="line">     */</span></div><div class="line">    <span class="function">Type <span class="title">getRawType</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用ParameterizedType例子如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericParamType</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">applyMethod</span><span class="params">(List&lt;Date&gt; list, String str)</span> <span class="keyword">throws</span> Exception</div><div class="line">    </span>&#123;</div><div class="line">        Method m = GenericParamType.class.getMethod(<span class="string">"applyMethod"</span>,List.class, String.class);</div><div class="line">        <span class="comment">// 其返回是参数的类型</span></div><div class="line">        Type[] t1 = m.getParameterTypes();</div><div class="line">        <span class="comment">//其返回的是参数的参数化的类型,里面的带有实际的参数类型</span></div><div class="line">        Type[] t2 = m.getGenericParameterTypes();</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (Type type : t1)&#123;</div><div class="line">            <span class="comment">//t1[0]:java.util.List</span></div><div class="line">            <span class="comment">//t1[1]:java.lang.String</span></div><div class="line">            System.err.println(type.getTypeName());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (Type type : t2)&#123;</div><div class="line">            <span class="comment">//t2[0]:java.util.List&lt;java.util.Date&gt;</span></div><div class="line">            <span class="comment">//t2[1]:java.lang.String</span></div><div class="line">            <span class="comment">//参数里面如果不是参数化类型的话，那么 getGenericParameterTypes就返回与 getParameterTypes 一样　</span></div><div class="line">            System.err.println(type.getTypeName());</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//获取泛型中参数化类型 t2[0]是泛型</span></div><div class="line">        ParameterizedType parameterizedType =  (ParameterizedType)t2[<span class="number">0</span>];</div><div class="line">        <span class="comment">//java.util.List</span></div><div class="line">        <span class="comment">//打印出原始类型</span></div><div class="line">        System.out.println(parameterizedType.getRawType().getTypeName());</div><div class="line">        <span class="comment">//获取泛型中的参数化类型,这里只有一个参数类型 Data</span></div><div class="line">        Type[] paramTypes = parameterizedType.getActualTypeArguments();</div><div class="line">        <span class="comment">//java.util.Date</span></div><div class="line">        System.err.println(paramTypes[<span class="number">0</span>].getTypeName());</div><div class="line"></div><div class="line">        <span class="comment">//false</span></div><div class="line">        <span class="comment">//第二个参数不是泛型，因此不能转换为 ParameterizedType</span></div><div class="line">        System.err.println(t2[<span class="number">1</span>] <span class="keyword">instanceof</span> ParameterizedType);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="数组类型GenericArrayType"><a href="#数组类型GenericArrayType" class="headerlink" title="数组类型GenericArrayType"></a>数组类型GenericArrayType</h2><p>在java中，代表数组类型的类是GenericArrayType.只有诸如Type[][]…形式的至少有一个[]即代表为数组的类型才能转化成GenericArrayType。内部只有一个方法，用于查询数组中的元素类型:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GenericArrayType</span> <span class="keyword">extends</span> <span class="title">Type</span> </span>&#123;</div><div class="line">    <span class="comment">/**</div><div class="line">     * Returns a &#123;<span class="doctag">@code</span> Type&#125; object representing the component type</div><div class="line">     * of this array. This method creates the component type of the</div><div class="line">     * array.  See the declaration of &#123;<span class="doctag">@link</span></div><div class="line">     * java.lang.reflect.ParameterizedType ParameterizedType&#125; for the</div><div class="line">     * semantics of the creation process for parameterized types and</div><div class="line">     * see &#123;<span class="doctag">@link</span> java.lang.reflect.TypeVariable TypeVariable&#125; for the</div><div class="line">     * creation process for type variables.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span>  a &#123;<span class="doctag">@code</span> Type&#125; object representing the component type</div><div class="line">     *     of this array</div><div class="line">     * <span class="doctag">@throws</span> TypeNotPresentException if the underlying array type's</div><div class="line">     *     component type refers to a non-existent type declaration</div><div class="line">     * <span class="doctag">@throws</span> MalformedParameterizedTypeException if  the</div><div class="line">     *     underlying array type's component type refers to a</div><div class="line">     *     parameterized type that cannot be instantiated for any reason</div><div class="line">     */</span></div><div class="line">    <span class="function">Type <span class="title">getGenericComponentType</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure>
<p>使用示例如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//数组类接口定义</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GenericArrayType</span> <span class="keyword">extends</span> <span class="title">Type</span> </span>&#123;</div><div class="line">    <span class="function">Type <span class="title">getGenericComponentType</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenType</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String[] str;</div><div class="line">    <span class="keyword">public</span> E[] e1;</div><div class="line">    <span class="keyword">public</span> ArrayList&lt;E&gt;[] ale;</div><div class="line">    <span class="keyword">public</span> E[][] e2;</div><div class="line">    <span class="comment">//不可转成GenericArrayType,class [[Ljava.lang.Integer;</span></div><div class="line">    <span class="keyword">public</span> Integer[][] ins;</div><div class="line">    <span class="comment">//不可转成GenericArrayType，class [Ljava.lang.String;</span></div><div class="line">    <span class="keyword">public</span> String[] str;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">        Type type = GenType.class.getDeclaredField(<span class="string">"ale"</span>).getGenericType();</div><div class="line">        System.out.println(type.toString());</div><div class="line">        <span class="comment">//从上一个输出可以看到是一个参数化类型或者类型变量数组类型，才可以强转</span></div><div class="line">        <span class="comment">//并且，基本类型对象数组也不能转为数组类型，因为代表固定class对象</span></div><div class="line">        System.out.println(((GenericArrayType)type).getGenericComponentType());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="comment">//输出</span></div><div class="line">java.util.ArrayList&lt;E&gt;[]</div><div class="line">java.util.ArrayList&lt;E&gt;</div></pre></td></tr></table></figure></p>
<p>于这个数组类型GenericArrayType需要说明的是：</p>
<ul>
<li>无论从左向右有几个[]并列，这个方法仅仅脱去最右边的[]之后剩下的内容就作为这个方法的返回值.</li>
<li>在通过反射获取得到类型是参数化类型数组或者是类型变量数组类型，才可以强转换为GenericArrayType数组类型对象，对内部的实际元素类型进行查询和处理；而主类型是基本数据类型对象或者String类型的数组，是不能转成数组类型的，因为他们已经是原子类型。</li>
</ul>
<h2 id="类型变量TypeVariable"><a href="#类型变量TypeVariable" class="headerlink" title="类型变量TypeVariable"></a>类型变量TypeVariable</h2><p>在java中类型变量用类TypeVariable表示。类型变量接口中有个方法getBounds()是用来获取上边界类型，原因是在类型变量定义时候只能使用extends关键字进行多边界限定，而不能使用super，所以关键字extends都代表的是类型变量的上边界。<br>若是将类型变量具体化。</p>
<p>类型变量使用示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstructorTest</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">CharSequence</span>&amp; <span class="title">Serializable</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        TypeVariable&lt;Class&lt;ConstructorTest&gt;&gt;[] t = ConstructorTest.class.getTypeParameters();</div><div class="line">        <span class="keyword">for</span>(TypeVariable&lt;Class&lt;ConstructorTest&gt;&gt; m : t) &#123;</div><div class="line">            <span class="comment">/**</div><div class="line">             * 获得类型变量在声明的时候的名称，此例中为T</div><div class="line">             * 输出：T</div><div class="line">             */</span></div><div class="line">            System.out.println(m.getName());</div><div class="line">            <span class="comment">/**</div><div class="line">             * 获得类型变量的上边界，若无显式的定义（extends）,默认为Object;类型变量的上边界可能不止一个，</div><div class="line">             * 因为可以用&amp;符号限定多个（这其中有且只能有一个为类或抽象类，且必须放在extends后的第一个，</div><div class="line">             * 即若有多个上边界，则第一个&amp;后必须为接口）</div><div class="line">             * </div><div class="line">             * 输出：</div><div class="line">             * interface java.lang.CharSequence</div><div class="line">             * interface java.io.Serializable</div><div class="line">             */</span></div><div class="line">            Type[] bounds = m.getBounds();</div><div class="line">            <span class="keyword">for</span>(Type t1 : bounds) &#123;</div><div class="line">                System.out.println(t1);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">/**</div><div class="line">             * 获得声明这个类型变量的类型及名称</div><div class="line">             * 输出：class reflect.ConstructorTest</div><div class="line">             */</span></div><div class="line">            System.out.println(m.getGenericDeclaration());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">`</div></pre></td></tr></table></figure>
<h2 id="通配符类型wildcardType"><a href="#通配符类型wildcardType" class="headerlink" title="通配符类型wildcardType"></a>通配符类型wildcardType</h2><p>表示通配符类型的类型，表示为wildcardType，通常用符号?来表示匹配。通常该类用来限定泛型类型的边界，包括上界和下界。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WildcardType</span> <span class="keyword">extends</span> <span class="title">Type</span> </span>&#123;</div><div class="line">    <span class="comment">//上界，? extends ...</span></div><div class="line">    Type[] getUpperBounds();</div><div class="line">    <span class="comment">//下界，? super ....</span></div><div class="line">    Type[] getLowerBounds();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>至于边界的返回值为什么声明为Type类型，可以从下面例子中看到：</p>
<ul>
<li>public static void printColl(ArrayList&lt;? extends ArrayList<string>&gt; al){}，其中通配符表达式是?extends ArrayList<string>,这样extends后面是?的上边界，这个上边界是参数化类型ParameterizedType。</string></string></li>
<li>public static <e> void printColl(ArrayList&lt;? extends E&gt; al){}，其中通配符表达式是? extends E&gt;,这样extends后面是?的上边界，这个上边界是类型变量TypeVariable类型。</e></li>
<li>public static <e> void printColl(ArrayList&lt;? extends E[]&gt; al){}，其中通配符表达式是? extends E[]&gt;,这样extends后面是?的上边界，这个上边界是类型变量GenericArrayType类型。</e></li>
<li>public static <e> void printColl(ArrayList&lt;? extends Number&gt; al){}，其中通配符表达式是? extends Number&gt;,这样extends后面是?的上边界，这个上边界是类型变量Class类型。<br>所以，综上的不同类型，得到的都是Type接口的子实现类。</e></li>
</ul>
<h3 id="extends与super"><a href="#extends与super" class="headerlink" title="extends与super"></a>extends与super</h3><ul>
<li>&lt;? extends T&gt; : 是指上界通配符(Upper Bounds Wildcards)</li>
<li>&lt;? super T&gt;: 是指下界通配符(Lower Bounds Wildcards)</li>
<li>子类转换为父类(小转大)是隐式的，而父类转换成子类，需要显示手动强制转换。</li>
<li>PECS(Producer Extends Consumer Super)原则：频繁往外读取内容的，适合用上界Extends。<br>经常往里插入的，适合用下界Super。</li>
</ul>
<ul>
<li>List&lt;? extends E&gt;表示该list集合中存放的都是E的子类型（包括E自身），由于E的子类型可能有很多，但是我们存放元素时实际上只能存放其中的一种子类型（这是为了泛型安全，因为其会在编译期间生成桥接方法<bridge_methods>该方法中会出现强制转换，若出现多种子类型，则会强制转换失败），例子如下：</bridge_methods></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">List&lt;? extends Number&gt; list=new ArrayList&lt;Number&gt;();</div><div class="line">list.add(4.0);//编译错误</div><div class="line">list.add(3);//编译错误</div></pre></td></tr></table></figure>
<p>上例中添加的元素类型不止一种，这样编译器强制转换会失败，为了安全，Java只能将其设计成不能添加元素。虽然List&lt;? extends E&gt;不能添加元素，但是由于其中的元素都有一个共性–有共同的父类，因此我们在获取元素时可以将他们统一强制转换为E类型，我们称之为get原则。</p>
<ul>
<li>对于List&lt;? super E&gt;其list中存放的都是E的父类型元素（包括E），我们在向其添加元素时，只能向其添加E的子类型元素（包括E类型），这样在编译期间将其强制转换为E类型时是类型安全的，因此可以添加元素，例子如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">List&lt;? <span class="keyword">super</span> Number&gt; list=<span class="keyword">new</span> ArrayList&lt;Number&gt;();</div><div class="line">list.add(<span class="number">2.0</span>);</div><div class="line">list.add(<span class="number">3.0</span>);</div></pre></td></tr></table></figure>
<p>但是，由于该集合中的元素都是E的父类型（包括E），其中的元素类型众多，在获取元素时我们无法判断是哪一种类型，故设计成不能获取元素，我们称之为put原则。实际上，我们采用extends，super来扩展泛型的目的是为了弥补例如List<e>只能存放一种特定类型数据的不足，将其扩展为List&lt;? extends E&gt; 使其可以接收E的子类型中的任何一种类型元素，这样使它的使用范围更广。</e></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="comment">//装苹果的盘子不是装水果的盘子，不等价</span></div><div class="line"><span class="comment">//      Plate&lt;Fruit&gt; fp = new Plate&lt;Apple&gt;(new Apple());</span></div><div class="line">        <span class="comment">//Plate&lt;? extends Fruit&gt; 是Plate&lt;Fruit&gt; 以及Plate&lt;Apple&gt;的基类</span></div><div class="line">        Plate&lt;? extends Fruit&gt; fp = <span class="keyword">new</span> Plate&lt;Apple&gt;(<span class="keyword">new</span> Apple());</div><div class="line"><span class="comment">//      fp.setItem(new Apple()); //error</span></div><div class="line"><span class="comment">//      fp.setItem(new Fruit()); //error</span></div><div class="line">        Fruit f = fp.getItem();</div><div class="line">        f.outf();</div><div class="line">        Object of = fp.getItem();</div><div class="line">        Apple apple = (Apple) fp.getItem();<span class="comment">//父类强制转化为子类</span></div><div class="line">        apple.outa();</div><div class="line">        System.out.println(apple);</div><div class="line">        </div><div class="line"><span class="comment">//      Plate&lt;? super Fruit&gt; sf = new Plate&lt;Apple&gt;(new Apple()); //error</span></div><div class="line">        <span class="comment">//sf,getItem() &gt;&gt; generic.Fruit@xxx</span></div><div class="line">        Plate&lt;? <span class="keyword">super</span> Fruit&gt; sf = <span class="keyword">new</span> Plate&lt;Fruit&gt;(<span class="keyword">new</span> Fruit());</div><div class="line">        <span class="comment">//sf,getItem() &gt;&gt; generic.Apple@xxx</span></div><div class="line">        <span class="comment">//强制转换 sf1 = new Plate&lt;Fruit&gt;((Fruit)new Apple())</span></div><div class="line">        Plate&lt;? <span class="keyword">super</span> Fruit&gt; sf1 = <span class="keyword">new</span> Plate&lt;Fruit&gt;(<span class="keyword">new</span> Apple());</div><div class="line">        ((Fruit)sf.getItem()).outf();</div><div class="line">        System.out.println(sf1.getItem().getClass());</div><div class="line">        ((Apple)sf1.getItem()).outa();</div><div class="line">        sf.setItem(<span class="keyword">new</span> Apple());</div><div class="line">    &#125;</div><div class="line"><span class="comment">//输出</span></div><div class="line">fruit</div><div class="line">apple</div><div class="line">generic.Apple@<span class="number">4</span>eb09321</div><div class="line">fruit</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">generic</span>.<span class="title">Apple</span></div><div class="line"><span class="title">apple</span></span></div></pre></td></tr></table></figure>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.jianshu.com/p/a1df99f202cc" target="_blank" rel="external">https://www.jianshu.com/p/a1df99f202cc</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/27/InnoDB加锁处理分析/" rel="next" title="InnoDB加锁处理分析">
                <i class="fa fa-chevron-left"></i> InnoDB加锁处理分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/lufei.jpg"
               alt="marc" />
          <p class="site-author-name" itemprop="name">marc</p>
           
              <p class="site-description motion-element" itemprop="description">Keep on going</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/amazingmarc" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://tech.meituan.com/" title="美团技术博客" target="_blank">美团技术博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://blog.csdn.net/v_JULY_v" title="v_JULY_v" target="_blank">v_JULY_v</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#泛型Type与Class"><span class="nav-number">2.</span> <span class="nav-text">泛型Type与Class</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Type详解"><span class="nav-number">3.</span> <span class="nav-text">Type详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#参数化类型ParameterizedType"><span class="nav-number">3.1.</span> <span class="nav-text">参数化类型ParameterizedType</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组类型GenericArrayType"><span class="nav-number">3.2.</span> <span class="nav-text">数组类型GenericArrayType</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类型变量TypeVariable"><span class="nav-number">3.3.</span> <span class="nav-text">类型变量TypeVariable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通配符类型wildcardType"><span class="nav-number">3.4.</span> <span class="nav-text">通配符类型wildcardType</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#extends与super"><span class="nav-number">3.4.1.</span> <span class="nav-text">extends与super</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考"><span class="nav-number">4.</span> <span class="nav-text">参考</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">marc</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
